//>>built
(function(a){"object"===typeof module&&"object"===typeof module.exports?(a=a(require,exports),void 0!==a&&(module.exports=a)):"function"===typeof define&&define.amd&&define("require exports tslib ../../shim/global ../../shim/WeakMap ../../shim/Map ../../core/lang ./Base".split(" "),a)})(function(a,e){Object.defineProperty(e,"__esModule",{value:!0});var f=a("tslib"),k=a("../../shim/global"),l=a("../../shim/WeakMap"),m=a("../../shim/Map"),n=a("../../core/lang");a=a("./Base");var d=Object.freeze({intersectionRatio:0,
isIntersecting:!1});a=function(a){function b(){var c=null!==a&&a.apply(this,arguments)||this;c._details=new m.default;c._onIntersect=function(p){return function(a){try{for(var g=f.__values(a),b=g.next();!b.done;b=g.next()){var h=b.value;p.set(h.target,{intersectionRatio:h.intersectionRatio,isIntersecting:h.isIntersecting})}}catch(q){d={error:q}}finally{try{b&&!b.done&&(e=g.return)&&e.call(g)}finally{if(d)throw d.error;}}c.invalidate();var d,e}};return c}f.__extends(b,a);b.prototype.get=function(c,
a){void 0===a&&(a={});var b;if(a.root&&(b=this.getNode(a.root),!b))return d;c=this.getNode(c);if(!c)return d;a=this._getDetails(a)||this._createDetails(a,b);a.entries.get(c)||(a.entries.set(c,d),a.observer.observe(c));return a.entries.get(c)||d};b.prototype.has=function(a,b){a=this.getNode(a);b=this._getDetails(b);return!!(b&&a&&b.entries.has(a))};b.prototype._createDetails=function(a,b){var c=new l.default,d=new k.default.IntersectionObserver(this._onIntersect(c),f.__assign({},a,{root:b}));b=f.__assign({observer:d,
entries:c},a);this._details.set(JSON.stringify(a),b);this.own(n.createHandle(function(){return d.disconnect()}));return b};b.prototype._getDetails=function(a){void 0===a&&(a={});return this._details.get(JSON.stringify(a))};return b}(a.Base);e.Intersection=a;e.default=a});