//>>built
(function(a){"object"===typeof module&&"object"===typeof module.exports?(a=a(require,exports),void 0!==a&&(module.exports=a)):"function"===typeof define&&define.amd&&define("require exports tslib ../shim/Promise ../shim/Map ../shim/Symbol ../core/Evented".split(" "),a)})(function(a,e){function f(a){return!(!a||a._type!==e.WIDGET_BASE_TYPE)}function g(a){return!!(a&&a.hasOwnProperty("__esModule")&&a.hasOwnProperty("default")&&f(a.default))}Object.defineProperty(e,"__esModule",{value:!0});var m=a("tslib"),
h=a("../shim/Promise"),k=a("../shim/Map"),n=a("../shim/Symbol"),l=a("../core/Evented");e.WIDGET_BASE_TYPE=n.default("Widget Base");e.isWidgetBaseConstructor=f;e.isWidgetConstructorDefaultExport=g;a=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}m.__extends(d,a);d.prototype.emitLoadedEvent=function(a,c){this.emit({type:a,action:"loaded",item:c})};d.prototype.define=function(a,c){var b=this;void 0===this._widgetRegistry&&(this._widgetRegistry=new k.default);if(this._widgetRegistry.has(a))throw Error("widget has already been registered for '"+
a.toString()+"'");this._widgetRegistry.set(a,c);c instanceof h.default?c.then(function(c){b._widgetRegistry.set(a,c);b.emitLoadedEvent(a,c);return c},function(a){throw a;}):f(c)&&this.emitLoadedEvent(a,c)};d.prototype.defineInjector=function(a,c){void 0===this._injectorRegistry&&(this._injectorRegistry=new k.default);if(this._injectorRegistry.has(a))throw Error("injector has already been registered for '"+a.toString()+"'");var b=new l.Evented;c={injector:c(function(){return b.emit({type:"invalidate"})}),
invalidator:b};this._injectorRegistry.set(a,c);this.emitLoadedEvent(a,c)};d.prototype.get=function(a){var c=this;if(!this._widgetRegistry||!this.has(a))return null;var b=this._widgetRegistry.get(a);if(f(b))return b;if(b instanceof h.default)return null;b=b();this._widgetRegistry.set(a,b);b.then(function(b){g(b)&&(b=b.default);c._widgetRegistry.set(a,b);c.emitLoadedEvent(a,b);return b},function(a){throw a;});return null};d.prototype.getInjector=function(a){return this._injectorRegistry&&this.hasInjector(a)?
this._injectorRegistry.get(a):null};d.prototype.has=function(a){return!(!this._widgetRegistry||!this._widgetRegistry.has(a))};d.prototype.hasInjector=function(a){return!(!this._injectorRegistry||!this._injectorRegistry.has(a))};return d}(l.Evented);e.Registry=a;e.default=a});